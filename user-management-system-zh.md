# 用户管理系统

## 系统概述

用户管理系统是一个现代化的 Web 平台，集成了用户认证、项目管理、应用部署和 TEE 密钥签名功能。系统采用无密码认证方式，支持邮箱验证码和 Google OAuth2 登录，为用户提供安全便捷的分布式应用部署和密钥管理服务。

## 核心功能

### 🔐 多重身份认证
- **无密码登录**：使用 6 位数邮箱验证码进行安全登录
- **Google OAuth2**：一键式 Google 账号登录
- **账户合并**：支持将邮箱验证和 Google 认证绑定到同一账户
- **会话管理**：基于 JWT 的无状态认证，默认 24 小时有效期

### 📊 项目管理
- **项目创建**：为每个项目分配唯一的 32 位 App ID
- **应用部署**：支持 ZIP、TAR、JAR、WAR 格式文件上传
- **服务配置**：内部/公开访问配置和端口映射
- **状态监控**：实时跟踪容器部署状态和健康状况

### 🔑 TEE 密钥管理
- **分布式密钥生成**：集成 TEE DAO 私钥分片系统
- **多协议支持**：ECDSA 和 Schnorr 签名协议
- **多曲线支持**：ED25519、SECP256K1、SECP256R1
- **项目关联**：为项目分配专用签名密钥

### 🚀 应用部署
- **容器化部署**：使用 Docker 容器运行用户应用
- **多语言支持**：自动检测并构建 Go、Node.js、Python 应用
- **服务暴露**：支持内部服务和公开 Web 服务
- **健康监控**：实时监控应用运行状态

## 业务流程

### 用户注册/登录流程
```
用户访问 → 选择登录方式 → 邮箱验证码/Google OAuth → 
账户创建/合并 → JWT 令牌 → 进入主界面
```

### 项目部署流程
```
创建项目 → 分配 App ID → 选择密钥 → 上传应用文件 → 
配置服务类型 → 推送到部署客户端 → Docker 构建 → 
容器启动 → 状态反馈 → 服务访问
```

### 密钥签名流程
```
应用请求签名 → App ID 查找公钥 → TEE 客户端管理器 → 
分布式签名协议 → 多节点协作 → 签名聚合 → 返回签名结果
```

## 安全特性

### 认证安全
- **无密码设计**：消除密码相关的安全漏洞
- **验证码限制**：防止暴力破解和垃圾邮件
- **OAuth2 安全**：状态参数验证防止 CSRF
- **会话管理**：JWT 令牌的安全生成和验证

### 输入验证
- **参数化查询**：使用 GORM ORM 防止 SQL 注入
- **输入清理**：服务器端验证和清理所有输入
- **文件验证**：上传文件的类型和大小限制
- **XSS 防护**：内容安全策略和输出编码

### 通信安全
- **TLS 加密**：所有 gRPC 通信使用 TLS 加密
- **证书验证**：双向 TLS 认证确保身份验证
- **TEE 集成**：密钥操作在可信执行环境中进行
- **容器隔离**：部署的应用在隔离的 Docker 容器中运行

### 审计和监控
- **操作日志**：详细的用户操作和系统事件日志
- **错误跟踪**：异常和错误的完整堆栈跟踪
- **性能监控**：API 响应时间和系统资源使用监控
- **安全事件**：登录失败和可疑活动的实时告警
